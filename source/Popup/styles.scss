@import "../styles/fonts";
@import "../styles/reset";
@import "../styles/variables";

body {
  font-size: 11px;
  font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
  color: $black;
  background-color: $greyWhite;
}

.dark-theme {
  // Apply new specific dark theme colors
  background-color: $dark-main-bg; // Main popup background
  color: $darkText; // General text color from existing dark theme

  // Header controls, title, etc. can inherit or use existing dark theme variables for now
  // unless specific overrides are needed for them with the new palette.
  .popup-title {
    color: $accent-color-logo; 
    border-bottom-color: $darkBorder; // Use existing $darkBorder or a new one if palette requires
  }
  .lottie-count-display {
    color: $darkMutedText;
  }
  .no-lotties-found {
    color: $darkMutedText;
  }

  // Card styling for both grid and list views
  .grid-view li, .list-view li { 
    background-color: $dark-card-bg; // New card background
    border-color: lighten($dark-card-bg, 10%); // Border slightly lighter than card

    &.selected-item { 
       border-color: $darkAccent; // Existing accent for selection
       box-shadow: 0 0 5px rgba($darkAccent, 0.6);
    }
  }

  // Preview area background
  .grid-view li div.preview, .list-view li div.preview {
    background-color: $dark-lottie-preview-bg; // New preview background
  }

  // Lottie tag, info icon - can use existing dark theme variables or new ones if needed
  .grid-view li .lottie-tag, .list-view li .lottie-tag {
    background-color: rgba(255, 255, 255, 0.15); 
    color: $darkText; 
  }
  .grid-view li .info-icon, .list-view li .info-icon {
    background-color: rgba(255, 255, 255, 0.25); 
    color: $darkText;
  }
  
  // Expanded details section styling
  .grid-view li .expanded-details, .list-view li .expanded-details {
    background-color: lighten($dark-card-bg, 5%); // Slightly lighter than card for distinct section
    border-color: lighten($dark-card-bg, 10%);
    
    .detail {
      border-bottom-color: lighten($dark-card-bg, 15%);
      .detail-key { 
        color: $dark-info-label-text; // New info label text color
      }
      .detail-value { 
        color: $dark-answer-text; // New answer text color (same as $accent-color-logo)
      }
    }
  }
  
  .list-view li { 
    border-bottom-color: lighten($dark-card-bg, 10%); 
  }

  // Buttons can use existing dark theme button styles
  .btn { 
    background: $darkButtonBackground;
    color: $darkText;
    &:hover {
      background-color: lighten($darkButtonBackground, 10%);
    }
  }
  .download-selected-btn { 
      background-color: $darkAccent !important; 
      color: $darkText !important; 
      &:hover {
        background-color: darken($darkAccent, 10%) !important;
      }
  }
  .download-btn {
    &.downloaded {
      background-color: #2E7D32 !important; 
      color: white !important; 
       &:hover {
        background-color: #1B5E20 !important;
      }
    }
  }
}

.player, .animation { // This seems to be a default size, ensure it fits dynamic sizing
  width: 100px;
  height: 100px;
}

#popup {
  min-width: 420px;
  padding: 15px; // Adjusted padding
  position: relative; // For positioning settings/toggle buttons

  .header-controls {
    position: absolute;
    top: 15px;
    right: 15px;
    display: flex;
    gap: 10px; // Space between buttons

    .icon-button {
      background-color: $skyBlue; // Use a variable color
      color: $greyWhite;
      border: none;
      cursor: pointer;
      padding: 5px 10px;
      border-radius: 3px;
      font-size: 10px;
      transition: background-color 0.3s;

      &:hover {
        background-color: darken($skyBlue, 10%);
      }
      // In a real scenario, you'd use SVGs or an icon font for actual icons
    }
  }

  .popup-title { // Changed from h2 to .popup-title to be more specific
    font-size: 18px; // Slightly larger
    font-weight: $bold;
    color: $accent-color-logo; // Apply accent color
    text-align: center;
    padding-bottom: 8px; // Adjusted padding
    margin-bottom: 10px; // Adjusted margin
    border-bottom: 1px solid #eee; // Lighter border
  }

  .lottie-count-display {
    font-size: 11px;
    text-align: center;
    color: #777;
    margin-bottom: 15px;
  }

  .no-lotties-found { // This class is no longer used, replaced by empty-state-container
    text-align: center;
    color: #888;
    margin-top: 20px;
    font-style: italic;
  }
  
  .empty-state-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 30px 20px; // More padding for empty state
    text-align: center;
    margin-top: 20px; // Space from header

    img {
      max-width: 80%; // Control image size, not too large
      height: auto;
      opacity: 0.7; // Slightly desaturate to blend
    }
  }

  .grid-view {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); // Responsive columns
    grid-template-rows: repeat(6, auto); // 6 rows
    grid-auto-flow: column; // Horizontal scroll
    overflow-x: auto; // Enable horizontal scroll
    gap: 15px; // Space between grid items
    padding-bottom: 10px; // Space for scrollbar
    min-height: calc(6 * (100px + 15px + 5px + 20px)); // item height + gap + details + actions (approx)

    .download-selected-btn {
      background-color: $darkAccent !important; // A distinct color for this primary action
      color: white !important;
      padding: 5px 10px !important;
      margin-right: auto; // Pushes other header controls to the right
      font-weight: $semibold;

      &:hover {
        background-color: darken($darkAccent, 10%) !important;
      }
    }
  }

  h2 {
    font-size: 16px;
    border-bottom: 1px solid #333;
    padding-bottom: 5px;
    margin-bottom: 15px; 
  }

  .grid-view, .list-view {
    padding-left: 0; // Remove default ul padding
    list-style-type: none; // Remove default list bullets
  }
  
  .grid-view {
    // ... (grid-view styles remain largely the same, li changes below) ...
    li {
      display: flex;
      flex-direction: column;
      position: relative; 
      background-color: #fff; // Add a card background
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 8px; // Padding for the card

      &.selected-item {
        border-color: $skyBlue;
        box-shadow: 0 0 5px rgba($skyBlue, 0.5);
      }

      .selection-checkbox-container {
        position: absolute;
        top: 8px;
        left: 8px;
        z-index: 10; // Above preview
        input[type="checkbox"] {
          cursor: pointer;
        }
      }

      .thumbnail-container {
        position: relative; 
        margin-bottom: 8px; // Increased space
        align-self: center; // Center preview container in grid item
      }
      
      div.preview {
        width: 100px;
        height: 100px;
        display: inline-flex;
        position: relative;
        background-color: #e9e9e9;
        border-radius: 3px;
        overflow: hidden;

        .player { width: 100%; height: 100%; }
      }

      .lottie-tag {
        position: absolute;
        top: 4px;
        // Adjusted left instead of right for checkbox space, or make checkbox smaller
        left: 28px; // Give space for checkbox if it's on the left of tag
        background-color: rgba(0, 0, 0, 0.5); 
        color: white; padding: 1px 4px; font-size: 8px; border-radius: 3px; opacity: 0.7;
      }

      .info-icon {
        position: absolute; bottom: 4px; right: 4px; background-color: rgba(0, 0, 0, 0.6);
        color: white; border: none; border-radius: 50%; width: 18px; height: 18px;
        font-size: 10px; line-height: 18px; text-align: center; cursor: pointer; opacity: 0.7;
        transition: opacity 0.2s;
        &:hover { opacity: 1; }
      }

      .expanded-details {
        background-color: #f9f9f9; padding: 8px; margin-top: 0;
        border: 1px solid #eee; border-top: none; border-radius: 0 0 3px 3px; font-size: 10px;
        .detail {
          display: flex; justify-content: space-between; padding: 2px 0;
          border-bottom: 1px dotted #ddd; &:last-child { border-bottom: none; }
          .detail-key { color: #555; font-weight: $semibold; margin-right: 5px; }
          .detail-value { color: #333; }
        }
      }
      
      div.actions {
        display: flex; flex-direction: column; align-items: stretch; width: 100%;
      }
    }
  }

  .list-view {
    // ... (list-view styles remain largely the same, li changes below) ...
    li {
      display: flex; flex-direction: row; align-items: flex-start; 
      border-bottom: 1px solid #eee; padding: 10px 0; // Padding on li itself
      position: relative;
      background-color: #fff; // Card background for list items too
      border-radius: 4px; // Rounded corners for list items
      margin-bottom: 8px; // Space between list items
      padding: 8px; // Padding for the card content

      &:last-child { border-bottom: none; margin-bottom: 0; }

      &.selected-item {
        border-color: $skyBlue;
        box-shadow: 0 0 5px rgba($skyBlue, 0.5);
      }
      
      .selection-checkbox-container {
        margin-right: 8px; // Space between checkbox and thumbnail
        display: flex;
        align-items: center; // Vertically align checkbox
        padding-top: 40px; // Align with center of thumbnail roughly
        input[type="checkbox"] {
          cursor: pointer;
        }
      }

      .thumbnail-container {
        display: flex; flex-direction: column; margin-right: 10px; flex-shrink: 0;
      }

      div.preview {
        width: 100px; height: 100px; position: relative;
        background-color: #e9e9e9; border-radius: 3px; overflow: hidden;
         .player { width: 100%; height: 100%;}
      }

      .lottie-tag {
        position: absolute; top: 4px; right: 4px; background-color: rgba(0, 0, 0, 0.5);
        color: white; padding: 1px 4px; font-size: 8px; border-radius: 3px; opacity: 0.7;
      }

      .info-icon {
        position: absolute; bottom: 4px; right: 4px; background-color: rgba(0, 0, 0, 0.6);
        color: white; border: none; border-radius: 50%; width: 18px; height: 18px;
        font-size: 10px; line-height: 18px; text-align: center; cursor: pointer; opacity: 0.7;
        &:hover { opacity: 1; }
      }
      
      .expanded-details {
        background-color: #f9f9f9; padding: 8px; border: 1px solid #eee; border-top: none;
        border-radius: 0 0 3px 3px; font-size: 10px; width: 100px;
        .detail {
          display: flex; justify-content: space-between; padding: 2px 0;
          border-bottom: 1px dotted #ddd; &:last-child { border-bottom: none; }
          .detail-key { color: #555; font-weight: $semibold; }
          .detail-value { color: #333; }
        }
      }

      div.actions {
        display: flex; flex-direction: column; align-items: stretch;
        width: 120px; flex-shrink: 0;
      }
    }
  }
  
  .dark-theme {
    .popup-title {
      color: $accent-color-logo; // Ensure accent color stands out in dark theme too
      border-bottom-color: $darkBorder;
    }
    .lottie-count-display {
      color: $darkMutedText;
    }
    .no-lotties-found { // This class is no longer used
      color: $darkMutedText;
    }
    .empty-state-container {
      img {
        opacity: 0.5; // Darken image slightly for dark theme
      }
    }

    .grid-view li, .list-view li { 
      background-color: $dark-card-bg; // Use new card bg for consistency
      border-color: lighten($dark-card-bg, 10%);
      &.selected-item { 
         border-color: $darkAccent; 
         box-shadow: 0 0 5px rgba($darkAccent, 0.6);
      }
    }

    .grid-view li div.preview, .list-view li div.preview {
      background-color: $dark-lottie-preview-bg; // Use new preview bg
    }

    .grid-view li .lottie-tag, .list-view li .lottie-tag {
      background-color: rgba(255, 255, 255, 0.15); color: $darkText; opacity: 0.8;
    }

    .grid-view li .info-icon, .list-view li .info-icon {
      background-color: rgba(255, 255, 255, 0.25); color: $darkText;
    }
    
    .grid-view li .expanded-details, .list-view li .expanded-details {
      background-color: lighten($dark-card-bg, 5%); 
      border-color: lighten($dark-card-bg, 10%);
      .detail {
        border-bottom-color: lighten($dark-card-bg, 15%);
        .detail-key { color: $dark-info-label-text; }
        .detail-value { color: $dark-answer-text; }
      }
    }
    
    .list-view li { border-bottom-color: lighten($dark-card-bg, 10%); }

    .btn { 
      background: $darkButtonBackground;
      color: $darkText;
      &:hover {
        background-color: lighten($darkButtonBackground, 10%);
      }
    }
    .download-selected-btn { 
        background-color: $darkAccent !important; 
        color: $darkText !important; 
        &:hover {
          background-color: darken($darkAccent, 10%) !important;
        }
    }
    .download-btn {
      &.downloaded {
        background-color: #2E7D32 !important; 
        color: white !important; 
         &:hover {
          background-color: #1B5E20 !important;
        }
      }
    }
  }
  
  .btn {
    display: flex; 
    justify-content: center; border-radius: 3px; font-size: 10px; padding: 5px 6px; // Slightly more padding
    background: $skyBlue; // Changed default background
    color: white;
    cursor: pointer;
    margin-bottom: 5px;
    transition: .3s;
    outline: none;
    border: none; 

    &:hover {
      background-color: rgba(37, 37, 56, 0.7);
    }

    &:active {
      box-shadow: inset 0 3px 4px hsla(0, 0%, 0%, 0.2);
    }
  }
}